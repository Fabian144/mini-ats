import{r as x,j as e}from"./vendor-radix-DY4qudGL.js";import{D as R,S as v,a as b,b as N,c as k,d as C,A as U,e as B,f as O,g as q,h as z,i as H,j as J,k as M,l as $}from"./select-D7EeeO1m.js";import{u as K,M as G,P as Q,L as y}from"./useCandidates-DcPtYUHi.js";import{u as W}from"./useJobs-BzRlCnPU.js";import{u as X,d as Y}from"./index-mAFw_Uzw.js";import{B as n,I as d,U as Z}from"./input-h_5tXWFu.js";import{L as l,C as u,d as j}from"./card-BUn8DwcO.js";import{T as ee,S as se}from"./textarea-DIWn28oX.js";import{D as ae,a as te,P as ne,b as le,c as ie,d as re,T as de}from"./dialog-D-8J6b1g.js";import{B as oe}from"./briefcase-RTyYyln2.js";import"./vendor-supabase-6c5mf4pY.js";import"./vendor-react-EpQGxqdE.js";import"./vendor-query-CH72qb2W.js";import"./vendor-recharts-zFAyUZWb.js";const A={new:"Ny",screening:"Screening",interview:"Intervju",offer:"Erbjudande",hired:"Anställd",rejected:"Avslag"};function ye(){const{isAdmin:D,adminViewAccount:o,user:w}=X(),{candidates:p,isLoading:L,createCandidate:S,updateCandidate:_,deleteCandidate:T}=K(),{jobs:c}=W(),[I,m]=x.useState(!1),[i,g]=x.useState(null),[a,t]=x.useState({name:"",email:"",phone:"",linkedin_url:"",job_id:"",status:"new",notes:""}),F=s=>{s.preventDefault(),i?_.mutate({id:i.id,...a}):S.mutate(a),h()},E=s=>{g(s),t({name:s.name,email:s.email||"",phone:s.phone||"",linkedin_url:s.linkedin_url||"",job_id:s.job_id,status:s.status,notes:s.notes||""}),m(!0)},h=()=>{m(!1),g(null),t({name:"",email:"",phone:"",linkedin_url:"",job_id:"",status:"new",notes:""})},V=D&&!o,f=o?.fullName||o?.email||w?.email,P=a.name.trim().length>0&&a.job_id.length>0;return e.jsx(R,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Kandidater"}),e.jsx("p",{className:"text-muted-foreground",children:"Alla dina kandidater på ett ställe"})]}),e.jsxs(ae,{open:I,onOpenChange:s=>s?m(!0):h(),children:[e.jsx(te,{asChild:!0,children:e.jsxs(n,{disabled:c.length===0||V,children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Lägg till kandidat"]})}),e.jsxs(le,{className:"max-w-md",children:[e.jsx(ie,{children:e.jsx(re,{children:i?"Redigera kandidat":"Lägg till kandidat"})}),f&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i?"Redigeras för konto":"Skapas för konto",e.jsx("span",{className:"font-medium",children:f})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"name",children:["Namn ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(d,{id:"name",value:a.name,onChange:s=>t({...a,name:s.target.value}),placeholder:"t.ex. Anna Andersson",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"job",children:["Jobb ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(v,{value:a.job_id,onValueChange:s=>t({...a,job_id:s}),required:!0,children:[e.jsx(b,{children:e.jsx(N,{placeholder:"Välj jobb"})}),e.jsx(k,{children:c.map(s=>e.jsxs(C,{value:s.id,children:[s.title," ",s.company&&`@ ${s.company}`]},s.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"E-post"}),e.jsx(d,{id:"email",type:"email",value:a.email,onChange:s=>t({...a,email:s.target.value}),placeholder:"anna@email.se"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Telefon"}),e.jsx(d,{id:"phone",value:a.phone,onChange:s=>t({...a,phone:s.target.value}),placeholder:"070-123 45 67"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"linkedin",children:"LinkedIn URL"}),e.jsx(d,{type:"url",id:"linkedin",value:a.linkedin_url,onChange:s=>t({...a,linkedin_url:s.target.value}),placeholder:"https://linkedin.com/in/..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(v,{value:a.status,onValueChange:s=>t({...a,status:s}),children:[e.jsx(b,{children:e.jsx(N,{})}),e.jsx(k,{children:Object.entries(A).map(([s,r])=>e.jsx(C,{value:s,children:r},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"notes",children:"Anteckningar"}),e.jsx(ee,{id:"notes",value:a.notes,onChange:s=>t({...a,notes:s.target.value}),placeholder:"Lägg till anteckningar om kandidaten...",rows:3})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(n,{type:"button",variant:"outline",onClick:h,children:"Avbryt"}),e.jsx(n,{type:"submit",disabled:!P,children:i?"Spara":"Lägg till"})]})]})]})]})]}),c.length===0&&e.jsx(u,{className:"mb-6 border-accent/50 bg-accent/5",children:e.jsx(j,{className:"py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Du behöver skapa ett jobb innan du kan lägga till kandidater."})})}),L?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Laddar..."}):p.length===0?e.jsx(u,{className:"text-center py-12",children:e.jsxs(j,{children:[e.jsx(Z,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium text-lg mb-2",children:"Inga kandidater ännu"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Lägg till din första kandidat"})]})}):e.jsx("div",{className:"grid gap-2 [grid-template-columns:repeat(auto-fit,minmax(min(100%,25em),1fr))]",children:p.map(s=>{const r=Y(s.linkedin_url);return e.jsx(u,{className:"w-full min-w-0",children:e.jsxs(j,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:s.name}),s.jobs&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:s.jobs.title})]})]}),e.jsx("span",{className:`status-badge status-${s.status}`,children:A[s.status]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:s.email||"Ingen e-post angiven"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:s.phone||"Inget telefonnummer angivet"})]}),r?e.jsxs("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-primary hover:underline",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"LinkedIn-profil"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"Ingen LinkedIn-profil angiven"})]})]}),e.jsxs("div",{className:"flex gap-1 pt-3 border-t border-border",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>E(s),children:[e.jsx(se,{className:"w-4 h-4 mr-1"}),"Redigera"]}),e.jsxs(U,{children:[e.jsx(B,{asChild:!0,children:e.jsxs(n,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),"Ta bort"]})}),e.jsxs(O,{children:[e.jsxs(q,{children:[e.jsx(z,{children:"Ta bort kandidat?"}),e.jsx(H,{children:"Detta tar bort kandidaten permanent. Åtgarden går inte att ångra."})]}),e.jsxs(J,{children:[e.jsx(M,{asChild:!0,children:e.jsx(n,{type:"button",variant:"outline",children:"Avbryt"})}),e.jsx($,{asChild:!0,children:e.jsx(n,{type:"button",variant:"destructive",onClick:()=>T.mutate(s.id),children:"Ta bort"})})]})]})]})]})]})},s.id)})})]})})}export{ye as default};
