import{r as i,j as e}from"./vendor-radix-og3wzDO_.js";import{u as S,a as U,s as P}from"./index-V309Dh23.js";import{B as l}from"./button-DtMPGEdD.js";import{U as m,L as u,I as h}from"./label-Bn_blq1I.js";import{C as p,a as x,b as f,c as g,d as j}from"./card-CCBrG6Tp.js";import{u as T}from"./vendor-react-B2XFA_K-.js";import"./vendor-supabase-6c5mf4pY.js";import"./vendor-recharts-qYF2F-lo.js";import"./vendor-query-CUB_NE-9.js";function A(){const[a,w]=i.useState(""),[d,v]=i.useState(""),[c,o]=i.useState(!1),{updatePassword:N,user:y,loading:b,signOut:k}=S(),r=T(),{toast:n}=U();if(i.useEffect(()=>{P.auth.getSession()},[]),b)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Laddar..."})});if(y)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-primary/10 mb-4",children:e.jsx(m,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"TalentTrack"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Ditt smarta rekryteringsverktyg"})]}),e.jsxs(p,{className:"glass-card",children:[e.jsxs(x,{className:"text-center pb-4",children:[e.jsx(f,{children:"Redan inloggad"}),e.jsx(g,{children:"Du måste vara utloggad för att kunna återställa lösenordet."})]}),e.jsxs(j,{className:"space-y-3",children:[e.jsx(l,{className:"w-full",onClick:async()=>{await k(),r("/auth",{replace:!0})},children:"Logga ut och försök igen"}),e.jsx(l,{className:"w-full",onClick:()=>r("/dashboard"),children:"Tillbaka till startsidan"})]})]})]})});const C=()=>{const s=new URL(window.location.href),t=new URLSearchParams(s.search);s.hash="",t.get("type")==="recovery"&&(t.delete("type"),s.search=t.toString()?`?${t.toString()}`:""),window.history.replaceState({},"",s.toString())},L=async s=>{if(s.preventDefault(),a.length<6){n({title:"Lösenordet är för kort",description:"Välj ett lösenord med minst 6 tecken.",variant:"destructive"});return}if(a!==d){n({title:"Lösenorden matchar inte",description:"Kontrollera att båda fälten har samma lösenord.",variant:"destructive"});return}o(!0);const{error:t}=await N(a);t?n({title:"Kunde inte uppdatera lösenord",description:t.message,variant:"destructive"}):(n({title:"Lösenord uppdaterat",description:"Du kan nu logga in med ditt nya lösenord."}),C(),r("/auth")),o(!1)};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-primary/10 mb-4",children:e.jsx(m,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"TalentTrack"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Ditt smarta rekryteringsverktyg"})]}),e.jsxs(p,{className:"glass-card",children:[e.jsxs(x,{className:"text-center pb-2",children:[e.jsx(f,{children:"Återställ lösenord"}),e.jsx(g,{children:"Välj ett nytt lösenord för ditt konto."})]}),e.jsx(j,{children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"new-password",children:["Nytt lösenord ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"new-password",type:"password",placeholder:"Minst 6 tecken",value:a,onChange:s=>w(s.target.value),required:!0,minLength:6})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"confirm-password",children:["Bekräfta lösenord ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"confirm-password",type:"password",placeholder:"Upprepa lösenordet",value:d,onChange:s=>v(s.target.value),required:!0,minLength:6})]}),e.jsx(l,{type:"submit",className:"w-full",disabled:c,children:c?"Uppdaterar...":"Uppdatera lösenord"}),e.jsx(l,{type:"button",variant:"link",className:"px-0",onClick:()=>r("/auth"),children:"Tillbaka till inloggning"})]})})]})]})})}export{A as default};
