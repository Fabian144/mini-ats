import{r as u,j as e}from"./vendor-radix-og3wzDO_.js";import{D as R,e as U,f as q,g as B,h as O,i as $,S as v,a as b,b as N,c as k,d as C,A as z,j as H,k as J,l as M,m as K,n as G,o as Q,p as W,q as X}from"./select-BYccXbgb.js";import{u as Y,M as Z,P as ee,L as y}from"./useCandidates-SUs99H91.js";import{u as se}from"./useJobs-DtUC83Pt.js";import{u as ae,d as te}from"./index-BsGsLOLQ.js";import{B as n}from"./button-D2hBkwze.js";import{L as l,I as o,U as ne}from"./label-GswY6gD1.js";import{T as le}from"./textarea-BfinDMtI.js";import{C as j,d as p}from"./card-BZLClowy.js";import{P as ie,S as re,T as de}from"./trash-2-C1VLgfot.js";import{B as oe}from"./briefcase-B_mQSYWa.js";import"./vendor-supabase-6c5mf4pY.js";import"./vendor-react-DChhcE8F.js";import"./vendor-query-CUB_NE-9.js";import"./vendor-recharts-qYF2F-lo.js";const w={new:"Ny",screening:"Screening",interview:"Intervju",offer:"Erbjudande",hired:"Anställd",rejected:"Avslag"};function we(){const{isAdmin:A,adminViewAccount:c,user:D}=ae(),{candidates:r,isLoading:L,createCandidate:S,updateCandidate:_,deleteCandidate:T}=Y(),{jobs:m}=se(),[I,h]=u.useState(!1),[i,g]=u.useState(null),[a,t]=u.useState({name:"",email:"",phone:"",linkedin_url:"",job_id:"",status:"new",notes:""}),F=s=>{s.preventDefault(),i?_.mutate({id:i.id,...a}):S.mutate(a),x()},E=s=>{g(s),t({name:s.name,email:s.email||"",phone:s.phone||"",linkedin_url:s.linkedin_url||"",job_id:s.job_id,status:s.status,notes:s.notes||""}),h(!0)},x=()=>{h(!1),g(null),t({name:"",email:"",phone:"",linkedin_url:"",job_id:"",status:"new",notes:""})},V=A&&!c,f=c?.fullName||c?.email||D?.email,P=a.name.trim().length>0&&a.job_id.length>0;return e.jsx(R,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Kandidater"}),e.jsx("p",{className:"text-muted-foreground",children:"Alla dina kandidater på ett ställe"})]}),e.jsxs(U,{open:I,onOpenChange:s=>s?h(!0):x(),children:[e.jsx(q,{asChild:!0,children:e.jsxs(n,{disabled:m.length===0||V,children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Lägg till kandidat"]})}),e.jsxs(B,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsx($,{children:i?"Redigera kandidat":"Lägg till kandidat"})}),f&&e.jsxs("p",{className:"text-m text-muted-foreground",children:[i?"Redigeras för konto: ":"Skapas för konto: ",e.jsx("span",{className:"font-medium",children:f})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"name",children:["Namn ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(o,{id:"name",value:a.name,onChange:s=>t({...a,name:s.target.value}),placeholder:"t.ex. Anna Andersson",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"job",children:["Jobb ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(v,{value:a.job_id,onValueChange:s=>t({...a,job_id:s}),required:!0,children:[e.jsx(b,{children:e.jsx(N,{placeholder:"Välj jobb"})}),e.jsx(k,{children:m.map(s=>e.jsxs(C,{value:s.id,children:[s.title," ",s.company&&`@ ${s.company}`]},s.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"E-post"}),e.jsx(o,{id:"email",type:"email",value:a.email,onChange:s=>t({...a,email:s.target.value}),placeholder:"anna@email.se"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Telefon"}),e.jsx(o,{id:"phone",value:a.phone,onChange:s=>t({...a,phone:s.target.value}),placeholder:"070-123 45 67"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"linkedin",children:"LinkedIn URL"}),e.jsx(o,{type:"url",id:"linkedin",value:a.linkedin_url,onChange:s=>t({...a,linkedin_url:s.target.value}),placeholder:"https://linkedin.com/in/..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(v,{value:a.status,onValueChange:s=>t({...a,status:s}),children:[e.jsx(b,{children:e.jsx(N,{})}),e.jsx(k,{children:Object.entries(w).map(([s,d])=>e.jsx(C,{value:s,children:d},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"notes",children:"Anteckningar"}),e.jsx(le,{id:"notes",value:a.notes,onChange:s=>t({...a,notes:s.target.value}),placeholder:"Lägg till anteckningar om kandidaten...",rows:3})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(n,{type:"button",variant:"outline",onClick:x,children:"Avbryt"}),e.jsx(n,{type:"submit",disabled:!P,children:i?"Spara":"Lägg till"})]})]})]})]})]}),m.length===0&&e.jsx(j,{className:"mb-6 border-accent/50 bg-accent/5",children:e.jsx(p,{className:"py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Du behöver skapa ett jobb innan du kan lägga till kandidater."})})}),L?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Laddar..."}):r.length===0?e.jsx(j,{className:"text-center py-12",children:e.jsxs(p,{children:[e.jsx(ne,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium text-lg mb-2",children:"Inga kandidater ännu"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Lägg till din första kandidat"})]})}):e.jsx("div",{className:`w-full ${r.length===2?"max-w-[1100px]":r.length===1?"max-w-[550px]":"max-w-[1900px]"}`,children:e.jsx("div",{className:"grid gap-2 [grid-template-columns:repeat(auto-fit,minmax(min(100%,28em),1fr))]",children:r.map(s=>{const d=te(s.linkedin_url);return e.jsx(j,{className:"w-full min-w-0",children:e.jsxs(p,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:s.name}),s.jobs&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:s.jobs.title})]})]}),e.jsx("span",{className:`status-badge status-${s.status}`,children:w[s.status]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:s.email||"Ingen e-post angiven"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{children:s.phone||"Inget telefonnummer angivet"})]}),d?e.jsxs("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-primary hover:underline",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"LinkedIn-profil"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"Ingen LinkedIn-profil angiven"})]})]}),e.jsxs("div",{className:"flex gap-1 pt-3 border-t border-border",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>E(s),children:[e.jsx(re,{className:"w-4 h-4 mr-1"}),"Redigera"]}),e.jsxs(z,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(n,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),"Ta bort"]})}),e.jsxs(J,{children:[e.jsxs(M,{children:[e.jsx(K,{children:"Ta bort kandidat?"}),e.jsx(G,{children:"Detta tar bort kandidaten permanent. Åtgarden går inte att ångra."})]}),e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsx(n,{type:"button",variant:"outline",children:"Avbryt"})}),e.jsx(X,{asChild:!0,children:e.jsx(n,{type:"button",variant:"destructive",onClick:()=>T.mutate(s.id),children:"Ta bort"})})]})]})]})]})]})},s.id)})})})]})})}export{we as default};
