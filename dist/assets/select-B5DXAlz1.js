import{h as K,i as G,r,j as e,k as Q,l as L,m as P,n as $,p as z,O as M,q as W,u as J,W as He,s as Ke,t as Ge,w as Qe,x as We,y as Je,z as Y,I as Ye,B as Xe,E as X,F as Ze,G as Z,H as ea,J as aa,S as ee,K as ae,M as te,N as se}from"./vendor-radix-og3wzDO_.js";import{b as ta,u as sa,L as B}from"./vendor-react-B2XFA_K-.js";import{u as ra}from"./vendor-query-CUB_NE-9.js";import{b as h,X as oa,c as i,u as ia,a as la,s as j}from"./index-V309Dh23.js";import{b as re,B as v}from"./button-DtMPGEdD.js";import{U as oe,L as V,I as H}from"./label-Bn_blq1I.js";import{B as na}from"./briefcase-hffvMhGs.js";const da=h("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const ie=h("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const ca=h("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const ma=h("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const pa=h("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const ua=h("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),fa=K,Ha=G,ga=Q,le=r.forwardRef(({className:s,...t},a)=>e.jsx(M,{ref:a,className:i("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));le.displayName=M.displayName;const ne=r.forwardRef(({className:s,children:t,...a},o)=>e.jsxs(ga,{children:[e.jsx(le,{}),e.jsxs(L,{ref:o,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",s),...a,children:[t,e.jsxs(P,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(oa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ne.displayName=L.displayName;const de=({className:s,...t})=>e.jsx("div",{className:i("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});de.displayName="DialogHeader";const ce=r.forwardRef(({className:s,...t},a)=>e.jsx($,{ref:a,className:i("text-lg font-semibold leading-none tracking-tight",s),...t}));ce.displayName=$.displayName;const me=r.forwardRef(({className:s,...t},a)=>e.jsx(z,{ref:a,className:i("text-sm text-muted-foreground",s),...t}));me.displayName=z.displayName;var pe="AlertDialog",[xa]=Qe(pe,[W]),m=W(),ue=s=>{const{__scopeAlertDialog:t,...a}=s,o=m(t);return e.jsx(K,{...o,...a,modal:!0})};ue.displayName=pe;var ha="AlertDialogTrigger",fe=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...o}=s,l=m(a);return e.jsx(G,{...l,...o,ref:t})});fe.displayName=ha;var ya="AlertDialogPortal",ge=s=>{const{__scopeAlertDialog:t,...a}=s,o=m(t);return e.jsx(Q,{...o,...a})};ge.displayName=ya;var ba="AlertDialogOverlay",xe=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...o}=s,l=m(a);return e.jsx(M,{...l,...o,ref:t})});xe.displayName=ba;var x="AlertDialogContent",[Na,ja]=xa(x),va=Ge("AlertDialogContent"),he=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,children:o,...l}=s,p=m(a),u=r.useRef(null),w=J(t,u),D=r.useRef(null);return e.jsx(He,{contentName:x,titleName:ye,docsSlug:"alert-dialog",children:e.jsx(Na,{scope:a,cancelRef:D,children:e.jsxs(L,{role:"alertdialog",...p,...l,ref:w,onOpenAutoFocus:Ke(l.onOpenAutoFocus,c=>{c.preventDefault(),D.current?.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[e.jsx(va,{children:o}),e.jsx(Da,{contentRef:u})]})})})});he.displayName=x;var ye="AlertDialogTitle",be=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...o}=s,l=m(a);return e.jsx($,{...l,...o,ref:t})});be.displayName=ye;var Ne="AlertDialogDescription",je=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...o}=s,l=m(a);return e.jsx(z,{...l,...o,ref:t})});je.displayName=Ne;var wa="AlertDialogAction",ve=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...o}=s,l=m(a);return e.jsx(P,{...l,...o,ref:t})});ve.displayName=wa;var we="AlertDialogCancel",De=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...o}=s,{cancelRef:l}=ja(we,a),p=m(a),u=J(t,l);return e.jsx(P,{...p,...o,ref:u})});De.displayName=we;var Da=({contentRef:s})=>{const t=`\`${x}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${x}\` by passing a \`${Ne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${x}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},Aa=ue,ka=fe,Sa=ge,Ae=xe,ke=he,Se=ve,Ce=De,_e=be,Re=je;const Ca=Aa,_a=ka,Ra=Sa,Ee=r.forwardRef(({className:s,...t},a)=>e.jsx(Ae,{className:i("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Ee.displayName=Ae.displayName;const Te=r.forwardRef(({className:s,...t},a)=>e.jsxs(Ra,{children:[e.jsx(Ee,{}),e.jsx(ke,{ref:a,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));Te.displayName=ke.displayName;const Ie=({className:s,...t})=>e.jsx("div",{className:i("flex flex-col space-y-2 text-center sm:text-left",s),...t});Ie.displayName="AlertDialogHeader";const Oe=({className:s,...t})=>e.jsx("div",{className:i("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Oe.displayName="AlertDialogFooter";const Le=r.forwardRef(({className:s,...t},a)=>e.jsx(_e,{ref:a,className:i("text-lg font-semibold",s),...t}));Le.displayName=_e.displayName;const Ea=r.forwardRef(({className:s,...t},a)=>e.jsx(Re,{ref:a,className:i("text-sm text-muted-foreground",s),...t}));Ea.displayName=Re.displayName;const Pe=r.forwardRef(({className:s,...t},a)=>e.jsx(Se,{ref:a,className:i(re(),s),...t}));Pe.displayName=Se.displayName;const $e=r.forwardRef(({className:s,...t},a)=>e.jsx(Ce,{ref:a,className:i(re({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));$e.displayName=Ce.displayName;const Ta=[{href:"/dashboard",icon:ma,label:"Kanban"},{href:"/jobs",icon:na,label:"Jobb"},{href:"/candidates",icon:oe,label:"Kandidater"}],Ka=r.memo(function({children:t}){const{user:a,signOut:o,isAdmin:l,adminViewAccount:p}=ia(),{toast:u}=la(),w=ta(),D=sa(),c=ra(),A=a?.user_metadata?.display_name??a?.user_metadata?.full_name??null,[Ue,U]=r.useState(A),[_,Fe]=r.useState(a?.email??""),R=l&&p?.id?p.id:a?.id,qe=p?.fullName||p?.email||"Alla konton",y=Ue||A,[E,b]=r.useState(!1),[k,T]=r.useState({fullName:y??"",email:a?.email??""}),[F,q]=r.useState(!1);r.useEffect(()=>{U(A??null)},[A,a?.id]),r.useEffect(()=>{Fe(a?.email??"")},[a?.email]),r.useEffect(()=>{E&&T({fullName:y??"",email:_})},[E,y,_]),r.useEffect(()=>{const n=()=>{document.visibilityState==="visible"&&j.auth.refreshSession().catch(()=>{})};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)},[]),r.useEffect(()=>{if(!R)return;const n=R;c.prefetchQuery({queryKey:["candidates",n],queryFn:async()=>{const{data:d,error:f}=await j.from("candidates").select("id, user_id, job_id, name, email, phone, linkedin_url, notes, status, created_at, updated_at, jobs(id, title, company)").order("created_at",{ascending:!1}).limit(200);if(f)throw f;return d},staleTime:1e3*60*2}),c.prefetchQuery({queryKey:["jobs",n],queryFn:async()=>{const{data:d,error:f}=await j.from("jobs").select("id, user_id, title, company, description, location, created_at, updated_at").order("created_at",{ascending:!1}).limit(200);if(f)throw f;return d},staleTime:1e3*60*2})},[R,c]);const Be=async()=>{await o(),D("/auth")},Ve=async n=>{if(n.preventDefault(),!a?.id)return;const d=k.fullName.trim(),f=k.email.trim(),I=d||null,O=f||null,S=I!==(y??null),N=O!==(a?.email??null);if(!S&&!N){b(!1);return}try{if(q(!0),N||S){const g={};N&&O&&(g.email=O),S&&(g.data={display_name:I});const{error:C}=await j.auth.updateUser(g,N?{emailRedirectTo:`${window.location.origin}/mini-ats/email-confirmed`}:void 0);if(C)throw C;await j.auth.refreshSession()}S&&U(I),u({title:"Uppdaterat!",description:N?"E-postbytet kräver bekräftelse via den nya mejladressen.":"Dina profiluppgifter har uppdaterats."}),b(!1)}catch(g){const C=g instanceof Error?g.message:"Kunde inte uppdatera profilen";u({title:"Något gick fel",description:C,variant:"destructive"})}finally{q(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col md:flex-row",children:[e.jsxs("aside",{className:"w-full md:w-64 bg-sidebar text-sidebar-foreground flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-sidebar-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-sidebar-primary flex items-center justify-center",children:e.jsx(oe,{className:"w-5 h-5 text-sidebar-primary-foreground"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg",children:"TalentTrack"}),e.jsx("p",{className:"text-xs text-sidebar-foreground/60",children:"Mini ATS"})]})]}),l&&e.jsxs("div",{className:"mt-3 rounded-md border border-sidebar-accent/40 bg-sidebar-accent/20 px-3 py-2",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-sidebar-foreground/60",children:"Visar konto"}),e.jsx("p",{className:"text-sm font-medium text-sidebar-foreground truncate",children:qe})]})]}),e.jsxs("nav",{className:"flex-1 p-4 space-y-1",children:[Ta.map(n=>{const d=w.pathname===n.href;return e.jsxs(B,{to:n.href,className:i("flex items-center gap-3 px-4 py-3 rounded-lg transition-colors",d?"bg-sidebar-accent text-sidebar-accent-foreground":"text-sidebar-foreground/70 hover:bg-sidebar-accent/50 hover:text-sidebar-foreground"),children:[e.jsx(n.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:n.label})]},n.href)}),l&&e.jsxs(B,{to:"/admin",className:i("flex items-center gap-3 px-4 py-3 rounded-lg transition-colors",w.pathname==="/admin"?"bg-sidebar-accent text-sidebar-accent-foreground":"text-sidebar-foreground/70 hover:bg-sidebar-accent/50 hover:text-sidebar-foreground"),children:[e.jsx(ua,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Admin"})]})]}),e.jsxs("div",{className:"p-4 border-t border-sidebar-border",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 px-4 py-2 mb-2 rounded-md text-left bg-blue-500/10 transition-colors hover:bg-blue-500/20",onClick:()=>b(!0),children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-sidebar-accent flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium",children:a?.email?.charAt(0)?.toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:y}),e.jsx("p",{className:"text-xs text-sidebar-foreground/60 truncate",children:_}),e.jsx("p",{className:"text-xs text-sidebar-foreground/60",children:l?"Admin":"Kund"})]})]}),e.jsxs(Ca,{children:[e.jsx(_a,{asChild:!0,children:e.jsxs(v,{variant:"ghost",className:"w-full justify-start text-sidebar-foreground/70 hover:text-sidebar-foreground hover:bg-sidebar-accent/50",children:[e.jsx(pa,{className:"w-4 h-4 mr-2"}),"Logga ut"]})}),e.jsxs(Te,{children:[e.jsx(Ie,{children:e.jsx(Le,{children:"Logga ut från kontot?"})}),e.jsxs(Oe,{children:[e.jsx($e,{asChild:!0,children:e.jsx(v,{type:"button",variant:"outline",children:"Avbryt"})}),e.jsx(Pe,{asChild:!0,children:e.jsx(v,{type:"button",onClick:Be,children:"Logga ut"})})]})]})]})]})]}),e.jsx(fa,{open:E,onOpenChange:b,children:e.jsxs(ne,{children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Uppdatera profil"}),e.jsx(me,{children:"Om du byter e-post måste du bekräfta bytet via den nya mejladressen."})]}),e.jsxs("form",{className:"space-y-4",onSubmit:Ve,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"profile-full-name",children:"Användarnamn"}),e.jsx(H,{id:"profile-full-name",value:k.fullName,onChange:n=>T(d=>({...d,fullName:n.target.value})),placeholder:"Ditt namn"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"profile-email",children:"E-post"}),e.jsx(H,{id:"profile-email",type:"email",value:k.email,onChange:n=>T(d=>({...d,email:n.target.value})),placeholder:"namn@foretag.se"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Avbryt"}),e.jsx(v,{type:"submit",disabled:F,children:F?"Sparar...":"Spara"})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-auto",children:t})]})}),Ga=We,Qa=Je,Ia=r.forwardRef(({className:s,children:t,...a},o)=>e.jsxs(Y,{ref:o,className:i("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(Ye,{asChild:!0,children:e.jsx(ie,{className:"h-4 w-4 opacity-50"})})]}));Ia.displayName=Y.displayName;const ze=r.forwardRef(({className:s,...t},a)=>e.jsx(ee,{ref:a,className:i("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ca,{className:"h-4 w-4"})}));ze.displayName=ee.displayName;const Me=r.forwardRef(({className:s,...t},a)=>e.jsx(ae,{ref:a,className:i("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ie,{className:"h-4 w-4"})}));Me.displayName=ae.displayName;const Oa=r.forwardRef(({className:s,children:t,position:a="popper",...o},l)=>e.jsx(Xe,{children:e.jsxs(X,{ref:l,className:i("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...o,children:[e.jsx(ze,{}),e.jsx(Ze,{className:i("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Me,{})]})}));Oa.displayName=X.displayName;const La=r.forwardRef(({className:s,...t},a)=>e.jsx(te,{ref:a,className:i("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));La.displayName=te.displayName;const Pa=r.forwardRef(({className:s,children:t,...a},o)=>e.jsxs(Z,{ref:o,className:i("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground data-[state=checked]:pl-8 group",s),...a,children:[e.jsx("span",{className:"absolute left-2 hidden h-3.5 w-3.5 items-center justify-center group-data-[state=checked]:flex",children:e.jsx(ea,{children:e.jsx(da,{className:"h-4 w-4"})})}),e.jsx(aa,{children:t})]}));Pa.displayName=Z.displayName;const $a=r.forwardRef(({className:s,...t},a)=>e.jsx(se,{ref:a,className:i("-mx-1 my-1 h-px bg-muted",s),...t}));$a.displayName=se.displayName;export{Ca as A,Ka as D,Ga as S,Ia as a,Qa as b,Oa as c,Pa as d,fa as e,Ha as f,ne as g,de as h,ce as i,_a as j,Te as k,Ie as l,Le as m,Ea as n,Oe as o,$e as p,Pe as q};
